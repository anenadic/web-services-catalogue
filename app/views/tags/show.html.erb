<%

# BioCatalogue: app/views/tags/show.html.erb
#
# Copyright (c) 2009, University of Manchester, The European Bioinformatics 
# Institute (EMBL-EBI) and the University of Southampton.
# See license.txt for details

%>

<% 
	count = @service_ids.length
	
%>

<% t "Results for tag '#{@tag.name}'" -%>

<h1>Tag Results</h1>

<p style="font-size: 123.1%;">
	Tag
	"<b><%= h(@tag.label) -%></b>"
  <% unless @tag.name == @tag.label %>
    (
    <%= @tag.name -%>
    )
  <% end %>
	returned <%= pluralize(count, "services") -%>
</p>

<span class="inline-block" style="float: right; margin: 10px 10px">
  <span style="vertical-align: middle; font-weight: bold;">
    Include archived services?
  </span>

  <span style="vertical-align: middle; padding: 0; margin-left: 0.1em; width: 100%;">
    <input type="checkbox"
           name="include_archived"
           id="include_archived"
           data-onchange-url="<%= generate_include_archived_url('tag', !include_archived?) %>"
           onchange="loadUrlFromCheckboxInputTag(this); return false;"
           <%= "checked='yes'" if include_archived? %> />
  </span>
</span>

<% if @service_ids.empty? %>

  <p class="none_text">No services.</p>

<% else %>
        <%
         services = Service.where(:id => @service_ids).paginate(:page => params[:page], :per_page => @per_page)
         #TODO figure out why current_page_ids only works as an array of Services rather than an array of ids
         current_page_ids = services

       #ORIGINAL
		 #current_page_ids = @service_ids.paginate(:page => params[:page], :per_page => @per_page)
         #services = search_item_ids_to_objects(current_page_ids, "service")
	 %>
	
	<%= render :partial => 'widgets/pagination_top', :locals => { :paginated_items => current_page_ids, :entry_name => 'service' } %>
	
	<div id="search_results" style="margin: 2em 0;">
		<%= render :partial => "services/listing", :locals => { :items => services } %>
	</div>
		
	<%= render :partial => 'widgets/pagination_bottom', :locals => { :paginated_items => current_page_ids } %>
	
<% end %>

<br />

